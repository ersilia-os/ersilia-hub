<div class="component-header">
    Model Management
</div>

<div class="component-toolbar">

    <div class="filters">
        <div class="filter">
            <mat-checkbox [(ngModel)]="filtersActiveOnly">Show Active Only</mat-checkbox>
        </div>

        <!-- TODO: input -->
        <!-- <div class="filter">
            <mat-checkbox [(ngModel)]="filtersSearchString">Resource Metrics</mat-checkbox>
        </div> -->

        <div class="spacer"></div>

        <div class="filter refresh">
            <div class="ersilia-button icon-only refresh" (click)="load()" [ngClass]="{'disabled': loading()}">
                @if(loading()) {
                <ersilia-loader [colour]="'#fffc'"></ersilia-loader>
                } @else {
                <mat-icon>refresh</mat-icon>
                }
            </div>
        </div>
    </div>

    <div class="actions">
        <div class="spacer"></div>
        <div class="action create">
            <div class="ersilia-button icon-only create" (click)="createModel()">
                <mat-icon>add</mat-icon>
            </div>
        </div>
    </div>
</div>

<div class="models-container">
    <table mat-table [dataSource]="models()" class="mat-elevation-z8" [trackBy]="trackBy">
        @for (column of displayedColumns; track column) {
        <ng-container [matColumnDef]="column">
            <th mat-header-cell *matHeaderCellDef>
                @if (column == 'actions') {
                <!-- hide actions header -->
                } @else {
                {{columnHeaders[column]}}
                }
            </th>

            <!-- 'enabled', 'id', 'description', 'resources', 'max_instances', 'exec_mode', 'actions' -->

            <td mat-cell *matCellDef="let element">
                @if (column == 'enabled') {
                <!-- TODO: on update call toggleModel() ?? -->
                <mat-checkbox [ngModel]="element[column]"></mat-checkbox>
                } @else if (column == 'resources') {
                TODO - resources
                } @else if (column == 'exec_mode') {
                TODO - exec mode
                } @else if (column == 'actions') {
                <div class="action-button" (click)="editModel(element)">
                    <mat-icon>create</mat-icon>
                </div>
                } @else {
                {{element[column]}}
                }
            </td>
        </ng-container>
        }

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
</div>